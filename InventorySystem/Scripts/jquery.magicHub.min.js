/*
 * ASP.NET SignalR JavaScript Library v2.0.1
 * http://signalr.net/
 *
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *
 */
(function(a,t,r){var p={nojQuery:"jQuery was not found. Please ensure jQuery is referenced before the SignalR client JavaScript file.",noTransportOnInit:"No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.",errorOnNegotiate:"Error during negotiation request.",stoppedWhileLoading:"The connection was stopped during page load.",stoppedWhileNegotiating:"The connection was stopped during the negotiate request.",errorParsingNegotiateResponse:"Error parsing negotiate response.",protocolIncompatible:"You are using a version of the client that isn't compatible with the server. Client version {0}, server version {1}.",sendFailed:"Send failed.",parseFailed:"Failed at parsing response: {0}",longPollFailed:"Long polling request failed.",eventSourceFailedToConnect:"EventSource failed to connect.",eventSourceError:"Error raised by EventSource",webSocketClosed:"WebSocket closed.",pingServerFailedInvalidResponse:"Invalid ping response when pinging server: '{0}'.",pingServerFailed:"Failed to ping server.",pingServerFailedStatusCode:"Failed to ping server.  Server responded with status code {0}, stopping the connection.",pingServerFailedParse:"Failed to parse ping server response, stopping the connection.",noConnectionTransport:"Connection is in an invalid state, there is no transport active."};if(typeof(a)!=="function"){throw new Error(p.nojQuery)}var q,b,d=(t.document.readyState==="complete"),e=a(t),c="__Negotiate Aborted__",l={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},g={processData:true,timeout:null,async:true,global:false,cache:false},o=function(w,u){if(u===false){return}var v;if(typeof(t.console)==="undefined"){return}v="["+new Date().toTimeString()+"] SignalR: "+w;if(t.console.debug){t.console.debug(v)}else{if(t.console.log){t.console.log(v)}}},h=function(u,v,w){if(v===u.state){u.state=w;a(u).triggerHandler(l.onStateChanged,[{oldState:v,newState:w}]);return true}return false},n=function(u){return u.state===q.connectionState.disconnected},i=function(v){var u=v._.config,w=function(x){a(v).triggerHandler(l.onError,[x])};if(!u.pingIntervalId&&u.pingInterval){v._.pingIntervalId=t.setInterval(function(){q.transports._logic.pingServer(v).fail(w)},u.pingInterval)}},j=function(u){var w,v;if(!u._.configuredStopReconnectingTimeout){v=function(x){x.log("Couldn't reconnect within the configured timeout ("+x.disconnectTimeout+"ms), disconnecting.");x.stop(false,false)};u.reconnecting(function(){var x=this;if(x.state===q.connectionState.reconnecting){w=t.setTimeout(function(){v(x)},x.disconnectTimeout)}});u.stateChanged(function(x){if(x.oldState===q.connectionState.reconnecting){t.clearTimeout(w)}});u._.configuredStopReconnectingTimeout=true}};q=function(w,v,u){return new q.fn.init(w,v,u)};q._={defaultContentType:"application/x-www-form-urlencoded; charset=UTF-8",ieVersion:(function(){var v,u;if(t.navigator.appName==="Microsoft Internet Explorer"){u=/MSIE ([0-9]+\.[0-9]+)/.exec(t.navigator.userAgent);if(u){v=t.parseFloat(u[1])}}return v})(),error:function(v,w){var u=new Error(v);u.source=w;return u},transportError:function(v,x,w){var u=this.error(v,w);u.transport=x?x.name:r;return u},format:function(){var v=arguments[0];for(var u=0;u<arguments.length-1;u++){v=v.replace("{"+u+"}",arguments[u+1])}return v},firefoxMajorVersion:function(v){var u=v.match(/Firefox\/(\d+)/);if(!u||!u.length||u.length<2){return 0}return parseInt(u[1],10)}};q.events=l;q.resources=p;q.ajaxDefaults=g;q.changeState=h;q.isDisconnecting=n;q.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4};q.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/js'></script>.")}};e.load(function(){d=true});function s(w,u){if(a.isArray(w)){for(var v=w.length-1;v>=0;v--){var x=w[v];if(a.type(w)!=="object"&&(a.type(x)!=="string"||!q.transports[x])){u.log("Invalid transport: "+x+", removing it from the transports list.");w.splice(v,1)}}if(w.length===0){u.log("No transports remain within the specified transport array.");w=null}}else{if(a.type(w)!=="object"&&!q.transports[w]&&w!=="auto"){u.log("Invalid transport: "+w.toString()+".");w=null}else{if(w==="auto"&&q._.ieVersion<=8){return["longPolling"]}}}return w}function m(u){if(u==="http:"){return 80}else{if(u==="https:"){return 443}}}function f(u,v){if(v.match(/:\d+$/)){return v}else{return v+":"+m(u)}}function k(v,w){var x=this,u=[];x.tryBuffer=function(y){if(v.state===a.signalR.connectionState.connecting){u.push(y);return true}return false};x.drain=function(){if(v.state===a.signalR.connectionState.connected){while(u.length>0){w(u.shift())}}};x.clear=function(){u=[]}}q.fn=q.prototype={init:function(x,w,v){var u=a(this);this.url=x;this.qs=w;this._={connectingMessageBuffer:new k(this,function(y){u.triggerHandler(l.onReceived,[y])}),onFailedTimeoutHandle:null};if(typeof(v)==="boolean"){this.logging=v}},_parseResponse:function(u){var v=this;if(!u){return u}else{if(v.ajaxDataType==="text"){return v.json.parse(u)}else{return u}}},json:t.JSON,isCrossDomain:function(w,u){var v;w=a.trim(w);if(w.indexOf("http")!==0){return false}u=u||t.location;v=t.document.createElement("a");v.href=w;return v.protocol+f(v.protocol,v.host)!==u.protocol+f(u.protocol,u.host)},ajaxDataType:"text",contentType:"application/json; charset=UTF-8",logging:false,state:q.connectionState.disconnected,keepAliveData:{},clientProtocol:"1.3",reconnectDelay:2000,transportConnectTimeout:0,disconnectTimeout:30000,keepAliveWarnAt:2/3,start:function(A,u){var w=this,v={pingInterval:300000,waitForPageLoad:true,transport:"auto",jsonp:false},y,x=w._deferral||a.Deferred(),B=t.document.createElement("a");w._deferral=x;if(!w.json){throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.")}if(a.type(A)==="function"){u=A}else{if(a.type(A)==="object"){a.extend(v,A);if(a.type(v.callback)==="function"){u=v.callback}}}v.transport=s(v.transport,w);if(!v.transport){throw new Error("SignalR: Invalid transport(s) specified, aborting start.")}w._.config=v;if(!d&&v.waitForPageLoad===true){w._.deferredStartHandler=function(){w.start(A,u)};e.bind("load",w._.deferredStartHandler);return x.promise()}if(w.state===q.connectionState.connecting){return x.promise()}else{if(h(w,q.connectionState.disconnected,q.connectionState.connecting)===false){x.resolve(w);return x.promise()}}j(w);B.href=w.url;if(!B.protocol||B.protocol===":"){w.protocol=t.document.location.protocol;w.host=t.document.location.host;w.baseUrl=w.protocol+"//"+w.host}else{w.protocol=B.protocol;w.host=B.host;w.baseUrl=B.protocol+"//"+B.host}w.wsProtocol=w.protocol==="https:"?"wss://":"ws://";if(v.transport==="auto"&&v.jsonp===true){v.transport="longPolling"}if(this.isCrossDomain(w.url)){w.log("Auto detected cross domain url.");if(v.transport==="auto"){v.transport=["webSockets","longPolling"]}if(typeof(v.withCredentials)==="undefined"){v.withCredentials=true}if(!v.jsonp){v.jsonp=!a.support.cors;if(v.jsonp){w.log("Using jsonp because this browser doesn't support CORS.")}}w.contentType=q._.defaultContentType}w.withCredentials=v.withCredentials;w.ajaxDataType=v.jsonp?"jsonp":"text";a(w).bind(l.onStart,function(E,D){if(a.type(u)==="function"){u.call(w)}x.resolve(w)});y=function(K,E){var G=q._.error(p.noTransportOnInit);E=E||0;if(E>=K.length){a(w).triggerHandler(l.onError,[G]);x.reject(G);w.stop();return}if(w.state===q.connectionState.disconnected){return}var J=K[E],I=a.type(J)==="object"?J:q.transports[J],F=false,H=function(){if(!F){F=true;t.clearTimeout(w._.onFailedTimeoutHandle);I.stop(w);y(K,E+1)}};w.transport=I;if(J.indexOf("_")===0){y(K,E+1);return}try{w._.onFailedTimeoutHandle=t.setTimeout(function(){w.log(I.name+" timed out when trying to connect.");H()},w.transportConnectTimeout);I.start(w,function(){var M=q._.firefoxMajorVersion(t.navigator.userAgent)>=11,L=!!w.withCredentials&&M;if(w.state===q.connectionState.disconnected){return}if(!F){F=true;t.clearTimeout(w._.onFailedTimeoutHandle);if(I.supportsKeepAlive&&w.keepAliveData.activated){q.transports._logic.monitorKeepAlive(w)}i(w);h(w,q.connectionState.connecting,q.connectionState.connected);w._.connectingMessageBuffer.drain();a(w).triggerHandler(l.onStart);e.bind("unload",function(){w.log("Window unloading, stopping the connection.");w.stop(L)});if(M){e.bind("beforeunload",function(){t.setTimeout(function(){w.stop(L)},0)})}}},H)}catch(D){w.log(I.name+" transport threw '"+D.message+"' when attempting to start.");H()}};var C=w.url+"/negotiate",z=function(F,D){var E=q._.error(p.errorOnNegotiate,F);a(D).triggerHandler(l.onError,E);x.reject(E);D.stop()};a(w).triggerHandler(l.onStarting);C=q.transports._logic.prepareQueryString(w,C);C=q.transports._logic.addQs(C,{clientProtocol:w.clientProtocol});w.log("Negotiating with '"+C+"'.");w._.negotiateRequest=a.ajax(a.extend({},a.signalR.ajaxDefaults,{xhrFields:{withCredentials:w.withCredentials},url:C,type:"GET",contentType:w.contentType,data:{},dataType:w.ajaxDataType,error:function(D,E){if(E!==c){z(D,w)}else{x.reject(q._.error(p.stoppedWhileNegotiating))}},success:function(H){var G,E,F,J=[],I=[];try{G=w._parseResponse(H)}catch(D){z(q._.error(p.errorParsingNegotiateResponse,D),w);return}E=w.keepAliveData;w.appRelativeUrl=G.Url;w.id=G.ConnectionId;w.token=G.ConnectionToken;w.webSocketServerUrl=G.WebSocketServerUrl;w.disconnectTimeout=G.DisconnectTimeout*1000;w.transportConnectTimeout=w.transportConnectTimeout+G.TransportConnectTimeout*1000;if(G.KeepAliveTimeout){E.activated=true;E.timeout=G.KeepAliveTimeout*1000;E.timeoutWarning=E.timeout*w.keepAliveWarnAt;E.checkInterval=(E.timeout-E.timeoutWarning)/3}else{E.activated=false}if(!G.ProtocolVersion||G.ProtocolVersion!==w.clientProtocol){F=q._.error(q._.format(p.protocolIncompatible,w.clientProtocol,G.ProtocolVersion));a(w).triggerHandler(l.onError,[F]);x.reject(F);return}a.each(q.transports,function(K){if(K==="webSockets"&&!G.TryWebSockets){return true}I.push(K)});if(a.isArray(v.transport)){a.each(v.transport,function(){var K=this;if(a.type(K)==="object"||(a.type(K)==="string"&&a.inArray(""+K,I)>=0)){J.push(a.type(K)==="string"?""+K:K)}})}else{if(a.type(v.transport)==="object"||a.inArray(v.transport,I)>=0){J.push(v.transport)}else{J=I}}y(J)}}));return x.promise()},starting:function(u){var v=this;a(v).bind(l.onStarting,function(x,w){u.call(v)});return v},send:function(v){var u=this;if(u.state===q.connectionState.disconnected){throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()")}if(u.state===q.connectionState.connecting){throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.")}u.transport.send(u,v);return u},received:function(u){var v=this;a(v).bind(l.onReceived,function(x,w){if(!v._.connectingMessageBuffer.tryBuffer(w)){u.call(v,w)}});return v},stateChanged:function(u){var v=this;a(v).bind(l.onStateChanged,function(x,w){u.call(v,w)});return v},error:function(u){var v=this;a(v).bind(l.onError,function(x,w){u.call(v,w)});return v},disconnected:function(u){var v=this;a(v).bind(l.onDisconnect,function(x,w){u.call(v)});return v},connectionSlow:function(u){var v=this;a(v).bind(l.onConnectionSlow,function(x,w){u.call(v)});return v},reconnecting:function(u){var v=this;a(v).bind(l.onReconnecting,function(x,w){u.call(v)});return v},reconnected:function(u){var v=this;a(v).bind(l.onReconnect,function(x,w){u.call(v)});return v},stop:function(u,x){var v=this,w=v._deferral;if(v._.deferredStartHandler){e.unbind("load",v._.deferredStartHandler)}delete v._deferral;delete v._.config;delete v._.deferredStartHandler;if(!d&&(!v._.config||v._.config.waitForPageLoad===true)){v.log("Stopping connection prior to negotiate.");if(w){w.reject(q._.error(p.stoppedWhileLoading))}return}if(v.state===q.connectionState.disconnected){return}try{v.log("Stopping connection.");t.clearTimeout(v._.onFailedTimeoutHandle);t.clearInterval(v._.pingIntervalId);if(v.transport){if(x!==false){v.transport.abort(v,u)}if(v.transport.supportsKeepAlive&&v.keepAliveData.activated){q.transports._logic.stopMonitoringKeepAlive(v)}v.transport.stop(v);v.transport=null}if(v._.negotiateRequest){v._.negotiateRequest.abort(c);delete v._.negotiateRequest}a(v).triggerHandler(l.onDisconnect);delete v.messageId;delete v.groupsToken;delete v.id;delete v._.pingIntervalId;v._.connectingMessageBuffer.clear()}finally{h(v,v.state,q.connectionState.disconnected)}return v},log:function(u){o(u,this.logging)}};q.fn.init.prototype=q.fn;q.noConflict=function(){if(a.connection===q){a.connection=b}return q};if(a.connection){b=a.connection}a.connection=a.signalR=q}(window.jQuery,window));(function(a,j,i){var g=a.signalR,e=a.signalR.events,c=a.signalR.changeState,h;g.transports={};function d(k){var m=k.keepAliveData,l,n;if(k.state===g.connectionState.connected){l=new Date();l.setTime(l-m.lastKeepAlive);n=l.getTime();if(n>=m.timeout){k.log("Keep alive timed out.  Notifying transport that connection has been lost.");k.transport.lostConnection(k)}else{if(n>=m.timeoutWarning){if(!m.userNotified){k.log("Keep alive has been missed, connection may be dead/slow.");a(k).triggerHandler(e.onConnectionSlow);m.userNotified=true}}else{m.userNotified=false}}}if(m.monitoring){j.setTimeout(function(){d(k)},m.checkInterval)}}function f(k){return k.state===g.connectionState.connected||k.state===g.connectionState.reconnecting}function b(m,l){var k=m.indexOf("?")!==-1?"&":"?";if(l){m+=k+"connectionData="+j.encodeURIComponent(l)}return m}h=g.transports._logic={pingServer:function(l){var k,n,m=a.Deferred();if(l.transport){k=l.transport.name==="webSockets"?"":l.baseUrl;n=k+l.appRelativeUrl+"/ping";n=h.prepareQueryString(l,n);a.ajax(a.extend({},a.signalR.ajaxDefaults,{xhrFields:{withCredentials:l.withCredentials},url:n,type:"GET",contentType:l.contentType,data:{},dataType:l.ajaxDataType,success:function(q){var o;try{o=l._parseResponse(q)}catch(p){m.reject(g._.transportError(g.resources.pingServerFailedParse,l.transport,p));l.stop();return}if(o.Response==="pong"){m.resolve()}else{m.reject(g._.transportError(g._.format(g.resources.pingServerFailedInvalidResponse,q.responseText),l.transport))}},error:function(o){if(o.status===401||o.status===403){m.reject(g._.transportError(g._.format(g.resources.pingServerFailedStatusCode,o.status),l.transport,o));l.stop()}else{m.reject(g._.transportError(g.resources.pingServerFailed,l.transport,o))}}}))}else{m.reject(g._.transportError(g.resources.noConnectionTransport,l.transport))}return m.promise()},prepareQueryString:function(k,l){l=h.addQs(l,k.qs);return b(l,k.data)},addQs:function(n,m){var k=n.indexOf("?")!==-1?"&":"?",l;if(!m){return n}if(typeof(m)==="object"){return n+k+a.param(m)}if(typeof(m)==="string"){l=m.charAt(0);if(l==="?"||l==="&"){k=""}return n+k+m}throw new Error("Query string property must be either a string or object.")},getUrl:function(l,p,o,m){var k=p==="webSockets"?"":l.baseUrl,q=k+l.appRelativeUrl,n="transport="+p+"&connectionToken="+j.encodeURIComponent(l.token);if(l.groupsToken){n+="&groupsToken="+j.encodeURIComponent(l.groupsToken)}if(!o){q+="/connect"}else{if(m){q+="/poll"}else{q+="/reconnect"}if(l.messageId){n+="&messageId="+j.encodeURIComponent(l.messageId)}}q+="?"+n;q=h.prepareQueryString(l,q);q+="&tid="+Math.floor(Math.random()*11);return q},maximizePersistentResponse:function(k){return{MessageId:k.C,Messages:k.M,Initialized:typeof(k.S)!=="undefined"?true:false,Disconnect:typeof(k.D)!=="undefined"?true:false,ShouldReconnect:typeof(k.T)!=="undefined"?true:false,LongPollDelay:k.L,GroupsToken:k.G}},updateGroups:function(k,l){if(l){k.groupsToken=l}},stringifySend:function(k,l){if(typeof(l)==="string"||typeof(l)==="undefined"||l===null){return l}return k.json.stringify(l)},ajaxSend:function(k,l){var n=h.stringifySend(k,l),o=k.url+"/send?transport="+k.transport.name+"&connectionToken="+j.encodeURIComponent(k.token),m=function(q,p){a(p).triggerHandler(e.onError,[g._.transportError(g.resources.sendFailed,p.transport,q),l])};o=h.prepareQueryString(k,o);return a.ajax(a.extend({},a.signalR.ajaxDefaults,{xhrFields:{withCredentials:k.withCredentials},url:o,type:k.ajaxDataType==="jsonp"?"GET":"POST",contentType:g._.defaultContentType,dataType:k.ajaxDataType,data:{data:n},success:function(r){var q;if(r){try{q=k._parseResponse(r)}catch(p){m(p,k);k.stop();return}a(k).triggerHandler(e.onReceived,[q])}},error:function(p,q){if(q==="abort"||q==="parsererror"){return}m(p,k)}}))},ajaxAbort:function(l,k){if(typeof(l.transport)==="undefined"){return}k=typeof k==="undefined"?true:k;var m=l.url+"/abort?transport="+l.transport.name+"&connectionToken="+j.encodeURIComponent(l.token);m=h.prepareQueryString(l,m);a.ajax(a.extend({},a.signalR.ajaxDefaults,{xhrFields:{withCredentials:l.withCredentials},url:m,async:k,timeout:1000,type:"POST",contentType:l.contentType,dataType:l.ajaxDataType,data:{}}));l.log("Fired ajax abort async = "+k+".")},tryInitialize:function(l,k){if(l.Initialized){k()}},processMessages:function(l,n,o){var m,k=a(l);if(l.transport&&l.transport.supportsKeepAlive&&l.keepAliveData.activated){this.updateKeepAlive(l)}if(n){m=this.maximizePersistentResponse(n);if(m.Disconnect){l.log("Disconnect command received from server.");l.stop(false,false);return}this.updateGroups(l,m.GroupsToken);if(m.MessageId){l.messageId=m.MessageId}if(m.Messages){a.each(m.Messages,function(p,q){k.triggerHandler(e.onReceived,[q])});h.tryInitialize(m,o)}}},monitorKeepAlive:function(k){var l=k.keepAliveData,m=this;if(!l.monitoring){l.monitoring=true;m.updateKeepAlive(k);k.keepAliveData.reconnectKeepAliveUpdate=function(){m.updateKeepAlive(k)};a(k).bind(e.onReconnect,k.keepAliveData.reconnectKeepAliveUpdate);k.log("Now monitoring keep alive with a warning timeout of "+l.timeoutWarning+" and a connection lost timeout of "+l.timeout+".");d(k)}else{k.log("Tried to monitor keep alive but it's already being monitored.")}},stopMonitoringKeepAlive:function(k){var l=k.keepAliveData;if(l.monitoring){l.monitoring=false;a(k).unbind(e.onReconnect,k.keepAliveData.reconnectKeepAliveUpdate);k.keepAliveData={};k.log("Stopping the monitoring of the keep alive.")}},updateKeepAlive:function(k){k.keepAliveData.lastKeepAlive=new Date()},ensureReconnectingState:function(k){if(c(k,g.connectionState.connected,g.connectionState.reconnecting)===true){a(k).triggerHandler(e.onReconnecting)}return k.state===g.connectionState.reconnecting},clearReconnectTimeout:function(k){if(k&&k._.reconnectTimeout){j.clearTimeout(k._.reconnectTimeout);delete k._.reconnectTimeout}},reconnect:function(k,n){var m=g.transports[n],l=this;if(f(k)&&!k._.reconnectTimeout){k._.reconnectTimeout=j.setTimeout(function(){m.stop(k);if(l.ensureReconnectingState(k)){k.log(n+" reconnecting.");m.start(k)}},k.reconnectDelay)}},handleParseFailure:function(k,n,l,m){if(k.state===g.connectionState.connecting){k.log("Failed to parse server response while attempting to connect.");m()}else{a(k).triggerHandler(e.onError,[g._.transportError(g._.format(g.resources.parseFailed,n),k.transport,l)]);k.stop()}},foreverFrame:{count:0,connections:{}}}}(window.jQuery,window));(function(a,g,f){var d=a.signalR,c=a.signalR.events,b=a.signalR.changeState,e=d.transports._logic;d.transports.webSockets={name:"webSockets",supportsKeepAlive:true,send:function(h,i){var j=e.stringifySend(h,i);h.socket.send(j)},start:function(i,k,j){var o,l=false,n=this,m=!k,h=a(i);if(!g.WebSocket){j();return}if(!i.socket){if(i.webSocketServerUrl){o=i.webSocketServerUrl}else{o=i.wsProtocol+i.host}o+=e.getUrl(i,this.name,m);i.log("Connecting to websocket endpoint '"+o+"'.");i.socket=new g.WebSocket(o);i.socket.onopen=function(){l=true;i.log("Websocket opened.");e.clearReconnectTimeout(i);if(b(i,d.connectionState.reconnecting,d.connectionState.connected)===true){h.triggerHandler(c.onReconnect)}};i.socket.onclose=function(p){if(this===i.socket){if(!l){if(j){j()}else{if(m){n.reconnect(i)}}return}else{if(typeof p.wasClean!=="undefined"&&p.wasClean===false){a(i).triggerHandler(c.onError,[d._.transportError(d.resources.webSocketClosed,i.transport,p)]);i.log("Unclean disconnect from websocket: "+p.reason||"[no reason given].")}else{i.log("Websocket closed.")}}n.reconnect(i)}};i.socket.onmessage=function(s){var q,p=a(i);try{q=i._parseResponse(s.data)}catch(r){e.handleParseFailure(i,s.data,r,j);return}if(q){if(a.isEmptyObject(q)||q.M){e.processMessages(i,q,k)}else{p.triggerHandler(c.onReceived,[q])}}}}},reconnect:function(h){e.reconnect(h,this.name)},lostConnection:function(h){this.reconnect(h)},stop:function(h){e.clearReconnectTimeout(h);if(h.socket){h.log("Closing the Websocket.");h.socket.close();h.socket=null}},abort:function(i,h){e.ajaxAbort(i,h)}}}(window.jQuery,window));(function(a,g,f){var d=a.signalR,c=a.signalR.events,b=a.signalR.changeState,e=d.transports._logic;d.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:true,timeOut:3000,start:function(i,l,k){var p=this,m=false,h=a(i),n=!l,q,o;if(i.eventSource){i.log("The connection already has an event source. Stopping it.");i.stop()}if(!g.EventSource){if(k){i.log("This browser doesn't support SSE.");k()}return}q=e.getUrl(i,this.name,n);try{i.log("Attempting to connect to SSE endpoint '"+q+"'.");i.eventSource=new g.EventSource(q)}catch(j){i.log("EventSource failed trying to connect with error "+j.Message+".");if(k){k()}else{h.triggerHandler(c.onError,[d._.transportError(d.resources.eventSourceFailedToConnect,i.transport,j)]);if(n){p.reconnect(i)}}return}if(n){o=g.setTimeout(function(){if(m===false){if(i.eventSource.readyState!==g.EventSource.OPEN){p.reconnect(i)}}},p.timeOut)}i.eventSource.addEventListener("open",function(r){i.log("EventSource connected.");if(o){g.clearTimeout(o)}e.clearReconnectTimeout(i);if(m===false){m=true;if(b(i,d.connectionState.reconnecting,d.connectionState.connected)===true){h.triggerHandler(c.onReconnect)}}},false);i.eventSource.addEventListener("message",function(r){var t;if(r.data==="initialized"){return}try{t=i._parseResponse(r.data)}catch(s){e.handleParseFailure(i,r.data,s,k);return}e.processMessages(i,t,l)},false);i.eventSource.addEventListener("error",function(r){if(this!==i.eventSource){return}if(!m){if(k){k()}return}i.log("EventSource readyState: "+i.eventSource.readyState+".");if(r.eventPhase===g.EventSource.CLOSED){i.log("EventSource reconnecting due to the server connection ending.");p.reconnect(i)}else{i.log("EventSource error.");h.triggerHandler(c.onError,[d._.transportError(d.resources.eventSourceError,i.transport,r)])}},false)},reconnect:function(h){e.reconnect(h,this.name)},lostConnection:function(h){this.reconnect(h)},send:function(h,i){e.ajaxSend(h,i)},stop:function(h){e.clearReconnectTimeout(h);if(h&&h.eventSource){h.log("EventSource calling close().");h.eventSource.close();h.eventSource=null;delete h.eventSource}},abort:function(i,h){e.ajaxAbort(i,h)}}}(window.jQuery,window));(function(a,h,g){var e=a.signalR,c=a.signalR.events,b=a.signalR.changeState,f=e.transports._logic,d=(function(){var k=null,j=1000,i=0;return{prevent:function(){if(e._.ieVersion<=8){if(i===0){k=h.setInterval(function(){var l=a("<iframe style='position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;' src=''></iframe>");a("body").append(l);l.remove();l=null},j)}i++}},cancel:function(){if(i===1){h.clearInterval(k)}if(i>0){i--}}}})();e.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:true,iframeClearThreshold:50,start:function(i,m,l){var n=this,k=(f.foreverFrame.count+=1),o,j=a("<iframe data-signalr-connection-id='"+i.id+"' style='position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;' src=''></iframe>");if(h.EventSource){if(l){i.log("This browser supports SSE, skipping Forever Frame.");l()}return}d.prevent();o=f.getUrl(i,this.name);o+="&frameId="+k;a("body").append(j);j.prop("src",o);f.foreverFrame.connections[k]=i;i.log("Binding to iframe's readystatechange event.");j.bind("readystatechange",function(){if(a.inArray(this.readyState,["loaded","complete"])>=0){i.log("Forever frame iframe readyState changed to "+this.readyState+", reconnecting.");n.reconnect(i)}});i.frame=j[0];i.frameId=k;if(m){i.onSuccess=function(){i.log("Iframe transport started.");m();delete i.onSuccess}}},reconnect:function(i){var j=this;h.setTimeout(function(){if(i.frame&&f.ensureReconnectingState(i)){var k=i.frame,l=f.getUrl(i,j.name,true)+"&frameId="+i.frameId;i.log("Updating iframe src to '"+l+"'.");k.src=l}},i.reconnectDelay)},lostConnection:function(i){this.reconnect(i)},send:function(i,j){f.ajaxSend(i,j)},receive:function(i,k){var j;f.processMessages(i,k,i.onSuccess);if(i.state===a.signalR.connectionState.connected){i.frameMessageCount=(i.frameMessageCount||0)+1;if(i.frameMessageCount>e.transports.foreverFrame.iframeClearThreshold){i.frameMessageCount=0;j=i.frame.contentWindow||i.frame.contentDocument;if(j&&j.document){a("body",j.document).empty()}}}},stop:function(i){var j=null;d.cancel();if(i.frame){if(i.frame.stop){i.frame.stop()}else{try{j=i.frame.contentWindow||i.frame.contentDocument;if(j.document&&j.document.execCommand){j.document.execCommand("Stop")}}catch(k){i.log("Error occured when stopping foreverFrame transport. errorMessage = "+k.message+".")}}a(i.frame).remove();delete f.foreverFrame.connections[i.frameId];i.frame=null;i.frameId=null;delete i.frame;delete i.frameId;delete i.onSuccess;delete i.frameMessageCount;i.log("Stopping forever frame.")}},abort:function(j,i){f.ajaxAbort(j,i)},getConnection:function(i){return f.foreverFrame.connections[i]},started:function(i){if(b(i,e.connectionState.reconnecting,e.connectionState.connected)===true){a(i).triggerHandler(c.onReconnect)}}}}(window.jQuery,window));(function(a,h,g){var e=a.signalR,c=a.signalR.events,b=a.signalR.changeState,d=a.signalR.isDisconnecting,f=e.transports._logic;e.transports.longPolling={name:"longPolling",supportsKeepAlive:false,reconnectDelay:3000,start:function(i,n,m){var q=this,j=function(){j=a.noop;i.log("LongPolling connected.");n();m=null},r=function(){if(m){m();m=null;i.log("LongPolling failed to connect.");return true}return false},o=i._,p=0,k=function(s){h.clearTimeout(o.reconnectTimeoutId);o.reconnectTimeoutId=null;if(b(s,e.connectionState.reconnecting,e.connectionState.connected)===true){s.log("Raising the reconnect event");a(s).triggerHandler(c.onReconnect)}},l=3600000;if(i.pollXhr){i.log("Polling xhr requests already exists, aborting.");i.stop()}i.messageId=null;o.reconnectTimeoutId=null;o.pollTimeoutId=h.setTimeout(function(){(function s(u,x){var v=u.messageId,t=(v===null),y=!t,w=!x,z=f.getUrl(u,q.name,y,w);if(d(u)===true){return}i.log("Opening long polling request to '"+z+"'.");u.pollXhr=a.ajax(a.extend({},a.signalR.ajaxDefaults,{xhrFields:{withCredentials:i.withCredentials},url:z,type:"GET",dataType:i.ajaxDataType,contentType:i.contentType,success:function(E){var D,B=0,A,F;i.log("Long poll complete.");p=0;try{D=i._parseResponse(E)}catch(C){f.handleParseFailure(u,E,C,r);return}if(o.reconnectTimeoutId!==null){k(u)}if(D){A=f.maximizePersistentResponse(D)}f.processMessages(u,D,j);if(A&&a.type(A.LongPollDelay)==="number"){B=A.LongPollDelay}if(A&&A.Disconnect){return}if(d(u)===true){return}F=A&&A.ShouldReconnect;if(F){if(!f.ensureReconnectingState(u)){return}}if(B>0){o.pollTimeoutId=h.setTimeout(function(){s(u,F)},B)}else{s(u,F)}},error:function(A,B){h.clearTimeout(o.reconnectTimeoutId);o.reconnectTimeoutId=null;if(B==="abort"){i.log("Aborted xhr request.");return}if(!r()){p++;if(i.state!==e.connectionState.reconnecting){i.log("An error occurred using longPolling. Status = "+B+".  Response = "+A.responseText+".");a(u).triggerHandler(c.onError,[e._.transportError(e.resources.longPollFailed,i.transport,A)])}if(!f.ensureReconnectingState(u)){return}o.pollTimeoutId=h.setTimeout(function(){s(u,true)},q.reconnectDelay)}}}));if(y&&x===true){o.reconnectTimeoutId=h.setTimeout(function(){k(u)},Math.min(1000*(Math.pow(2,p)-1),l))}}(i))},250)},lostConnection:function(i){throw new Error("Lost Connection not handled for LongPolling")},send:function(i,j){f.ajaxSend(i,j)},stop:function(i){h.clearTimeout(i._.pollTimeoutId);h.clearTimeout(i._.reconnectTimeoutId);delete i._.pollTimeoutId;delete i._.reconnectTimeoutId;if(i.pollXhr){i.pollXhr.abort();i.pollXhr=null;delete i.pollXhr}},abort:function(j,i){f.ajaxAbort(j,i)}}}(window.jQuery,window));(function(a,l,k){var c=".hubProxy",j=a.signalR;function h(m){return m+c}function i(m,n,r){var o,p=m.length,q=[];for(o=0;o<p;o+=1){if(m.hasOwnProperty(o)){q[o]=n.call(r,m[o],o,m)}}return q}function d(m){return a.isFunction(m)?null:(a.type(m)==="undefined"?null:m)}function e(n){for(var m in n){if(n.hasOwnProperty(m)){return true}}return false}function b(p,q){var o=p._.invocationCallbacks,m;if(e(o)){p.log("Clearing hub invocation callbacks with error: "+q+".")}p._.invocationCallbackId=0;delete p._.invocationCallbacks;p._.invocationCallbacks={};for(var n in o){m=o[n];m.method.call(m.scope,{E:q})}}function g(m,n){return new g.fn.init(m,n)}g.fn=g.prototype={init:function(m,n){this.state={};this.connection=m;this.hubName=n;this._={callbackMap:{}}},hasSubscriptions:function(){return e(this._.callbackMap)},on:function(o,m){var p=this,n=p._.callbackMap;o=o.toLowerCase();if(!n[o]){n[o]={}}n[o][m]=function(r,q){m.apply(p,q)};a(p).bind(h(o),n[o][m]);return p},off:function(p,m){var q=this,n=q._.callbackMap,o;p=p.toLowerCase();o=n[p];if(o){if(o[m]){a(q).unbind(h(p),o[m]);delete o[m];if(!e(o)){delete n[p]}}else{if(!m){a(q).unbind(h(p));delete n[p]}}}return q},invoke:function(s){var t=this,p=t.connection,m=a.makeArray(arguments).slice(1),n=i(m,d),r={H:t.hubName,M:s,A:n,I:p._.invocationCallbackId},q=a.Deferred(),o=function(v){var w=t._maximizeHubResponse(v),x,u;a.extend(t.state,w.State);if(w.Error){if(w.StackTrace){p.log(w.Error+"\n"+w.StackTrace+".")}x=w.IsHubException?"HubException":"Exception";u=j._.error(w.Error,x);u.data=w.ErrorData;q.rejectWith(t,[u])}else{q.resolveWith(t,[w.Result])}};p._.invocationCallbacks[p._.invocationCallbackId.toString()]={scope:t,method:o};p._.invocationCallbackId+=1;if(!a.isEmptyObject(t.state)){r.S=t.state}p.send(r);return q.promise()},_maximizeHubResponse:function(m){return{State:m.S,Result:m.R,Id:m.I,IsHubException:m.H,Error:m.E,StackTrace:m.T,ErrorData:m.D}}};g.fn.init.prototype=g.fn;function f(o,m){var n={qs:null,logging:false,useDefaultPath:true};a.extend(n,m);if(!o||n.useDefaultPath){o=(o||"")+"/signalr"}return new f.fn.init(o,n)}f.fn=f.prototype=a.connection();f.fn.init=function(p,n){var o={qs:null,logging:false,useDefaultPath:true},m=this;a.extend(o,n);a.signalR.fn.init.call(m,p,o.qs,o.logging);m.proxies={};m._.invocationCallbackId=0;m._.invocationCallbacks={};m.received(function(v){var r,w,s,q,u,t;if(!v){return}if(typeof(v.I)!=="undefined"){s=v.I.toString();q=m._.invocationCallbacks[s];if(q){m._.invocationCallbacks[s]=null;delete m._.invocationCallbacks[s];q.method.call(q.scope,v)}}else{r=this._maximizeClientHubInvocation(v);m.log("Triggering client hub event '"+r.Method+"' on hub '"+r.Hub+"'.");u=r.Hub.toLowerCase();t=r.Method.toLowerCase();w=this.proxies[u];a.extend(w.state,r.State);a(w).triggerHandler(h(t),[r.Args])}});m.error(function(u,v){var s,r,q;if(m.transport&&m.transport.name==="webSockets"){return}if(!v){return}try{s=l.JSON.parse(v);if(!s.I){return}}catch(t){return}r=s.I;q=m._.invocationCallbacks[r];q.method.call(q.scope,{E:u});m._.invocationCallbacks[r]=null;delete m._.invocationCallbacks[r]});m.reconnecting(function(){if(m.transport&&m.transport.name==="webSockets"){b(m,"Connection started reconnecting before invocation result was received.")}});m.disconnected(function(){b(m,"Connection was disconnected before invocation result was received.")})};f.fn._maximizeClientHubInvocation=function(m){return{Hub:m.H,Method:m.M,Args:m.A,State:m.S}};f.fn._registerSubscribedHubs=function(){var m=this;if(!m._subscribedToHubs){m._subscribedToHubs=true;m.starting(function(){var n=[];a.each(m.proxies,function(o){if(this.hasSubscriptions()){n.push({name:o});m.log("Client subscribed to hub '"+o+"'.")}});if(n.length===0){m.log("No hubs have been subscribed to.  The client will not receive data from hubs.  To fix, declare at least one client side function prior to connection start for each hub you wish to subscribe to.")}m.data=m.json.stringify(n)})}};f.fn.createHubProxy=function(m){m=m.toLowerCase();var n=this.proxies[m];if(!n){n=g(this,m);this.proxies[m]=n}this._registerSubscribedHubs();return n};f.fn.init.prototype=f.fn;a.hubConnection=f}(window.jQuery,window));(function(a,b){a.signalR.version="2.0.1"}(window.jQuery));/*
 * ASP.NET SignalR JavaScript Library v2.0.1
 * http://signalr.net/
 *
 * Copyright Microsoft Open Technologies, Inc. All rights reserved.
 * Licensed under the Apache 2.0
 * https://github.com/SignalR/SignalR/blob/master/LICENSE.md
 *
 */
(function(a,f,e){if(typeof(a.signalR)!=="function"){throw new Error("SignalR: SignalR is not loaded. Please ensure jquery.signalR-x.js is referenced before ~/signalr/js.")}var d=a.signalR;function b(h,g){return function(){g.apply(h,a.makeArray(arguments))}}function c(h,l){var i,g,j,k,m;for(i in h){if(h.hasOwnProperty(i)){g=h[i];if(!(g.hubName)){continue}if(l){m=g.on}else{m=g.off}for(j in g.client){if(g.client.hasOwnProperty(j)){k=g.client[j];if(!a.isFunction(k)){continue}m.call(g,j,b(g,k))}}}}}a.hubConnection.prototype.createHubProxies=function(){var g={};this.starting(function(){c(g,true);this._registerSubscribedHubs()}).disconnected(function(){c(g,false)});g.topicBroker=this.createHubProxy("topicBroker");g.topicBroker.client={};g.topicBroker.server={send:function(j,i,h){return g.topicBroker.invoke.apply(g.topicBroker,a.merge(["Send"],a.makeArray(arguments)))},subscribe:function(i,h){return g.topicBroker.invoke.apply(g.topicBroker,a.merge(["Subscribe"],a.makeArray(arguments)))},unsubscribe:function(i,h){return g.topicBroker.invoke.apply(g.topicBroker,a.merge(["Unsubscribe"],a.makeArray(arguments)))}};return g};d.hub=a.hubConnection("/magic-hub/signalr/",{useDefaultPath:false});a.extend(d,d.hub.createHubProxies())}(window.jQuery,window));(function(a,z){if(typeof(a)!=="function"){throw new Error("SignalR.MagicHub: jQuery not found. Please ensure jQuery is referenced before the SignalR.js file.")}if(!z.JSON){throw new Error("SignalR.MagicHub: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.")}if(!a.connection){throw new Error("SignalR.MagicHub: SignalR not found. Please ensure jquery.signalR is reference before the jquery.magicHub.js file")}if(!a.connection.topicBroker){throw new Error("SignalR.MagicHub: SignalR hub not found. Please ensure jquery.hub is reference before the jquery.magicHub.js file")}var v=function(){var G={};var F="<nofilter>";var B=function(H){return G[H]=G[H]||{}};var A=function(K,I){var J=G[K]=G[K]||{};var H=J[I]=J[I]||[];return H};var D=function(J,I,H){I=I||F;A(J,I).push(H)};var C=function(N,K,H){if(!H&&K&&typeof K==="function"){H=K;K=undefined}if(K){var I=A(N,K);var M=I.indexOf(H);if(M>-1){delete I[M]}}else{var L=B(N);for(var K in L){var I=L[K]||[];for(var M=I.length-1;M>=0;M--){var J=I[M];if(J==H){delete I[M]}}}}};var E=function(N,K,M){if(!M&&K){M=K;K=null}var I=A(N,K||F);for(var L=0;L<I.length;L++){var H=I[L];if(H){var J=a.Event(N);H.apply(this,[J,M])}}};return{on:D,off:C,trigger:E}};a.magicHub={debug:false};a.signalR.ajaxTimeout=5000;var w=a.connection.topicBroker,b=a.signalR.connectionState.connecting;var x=[],c=[],f=new v();var j=false,k=false,u=null;var y={log:function(F,D,E){if(E===false){return}if(typeof(z.console)==="undefined"){return}var B={datetime:new Date().toISOString(),source:"SignalR.MagicHub",level:D||"debug",message:F};var A="{datetime} {source}: [{level}] {message}";for(var C in B){A=A.replace("{"+C+"}",B[C])}if(z.console.debug){z.console.debug(A)}else{if(z.console.log){z.console.log(A)}}}};var n=function(B){var A=document.createElement("a");A.href=B;return{href:A.href,host:A.host||location.host,port:("0"===A.port||""===A.port)?location.port:A.port,hash:A.hash,hostname:A.hostname||location.hostname,pathname:A.pathname.charAt(0)!="/"?"/"+A.pathname:A.pathname,protocol:!A.protocol||":"==A.protocol?location.protocol:A.protocol,search:A.search,query:A.search.slice(1)}};var i=function(A){A=n(A);return A.hostname!==location.hostname||A.port!==location.port||A.protocol!==location.protocol};var s=function(D,C,A){try{w.server.subscribe(D,C).done(g(A)).fail(h(A));x.push({topic:D,filter:C})}catch(B){A.reject(B)}};var o=function(B,A){w.server.subscribe(B,A)};var q=function(){if(c.length>0){if(k){a.each(c,function(){this.deferred.reject()});c=[]}else{if(j&&b===a.signalR.connectionState.connected){a.each(c,function(){s(this.topic,this.filter,this.deferred)});c=[]}else{setTimeout(q,1000)}}}};var d=function(B,A){f.trigger(B,A)};w.client.serverOrderedDisconnect=function(A){a.connection.hub.stop();if(A){}};w.client.onmessage=function(E,B,D){try{var C=JSON.parse(D);if(C.tracing_enabled===true){y.log("Received topic: "+E+"; message: "+D+(B?("; filter: "+B):""),"trace")}f.trigger(E,B,C)}catch(A){y.log("Error parsing received message;"+A)}};var h=function(A){return function(B){if(a.magicHub.debug){y.log(B,"trace")}A.reject(B)}};var g=function(A){return function(){A.resolve()}};var r=function(G,A,E){var B=a.Deferred();if(a.connection.hub.state!==a.signalR.connectionState.connected){B.reject("SignalR.MagicHub: Connection must be fully connected before a message can be sent.");return B.promise()}var F=JSON.stringify(A);try{if(A.tracing_enabled===true){y.log("Sending topic: "+G+"; message: "+F,"trace")}}catch(D){}try{w.server.send(G,F,E).done(g(B)).fail(h(B))}catch(C){y.log(C.message);B.reject(C)}return B.promise()};var m=function(D,C,A){if(!A&&C&&typeof C=="function"){A=C;C=undefined}var B=a.Deferred();f.on(D,C,A);if(D!=="/state/change"){if(b===a.signalR.connectionState.connected){s(D,C,B)}else{if(k){B.reject()}else{c.push({topic:D,filter:C,deferred:B})}}}else{B.resolve()}return B.promise()};var l=function(D,C,A){if(!A&&C&&typeof C==="function"){A=C;C=undefined}var B=a.Deferred();f.off(D,C,A);if(D!=="/state/change"){if(b===a.signalR.connectionState.connected){w.server.unsubscribe(D,C).done(g(B)).fail(h(B))}else{if(k){B.reject()}else{}}}return B.promise()};var t=function(B){if(u){return u.promise()}u=a.Deferred();var A={waitForPageLoad:false,transport:"auto",jsonp:false};a.extend(A,B);if(A.url){a.connection.hub.url=n(B.url).href;if(i(B.url)){A.jsonp=!a.support.cors;if(A.transport==="auto"){A.transport=["webSockets","longPolling"]}}}a.connection.hub.error(function(C){if((C.source.status&&C.source.responseText)&&C.source.status===500&&C.source.responseText.indexOf("The user identity cannot change during ")>-1){y.log("Session expiration error detected. Emitting session close message.");a.connection.topicBroker.client.onmessage("nnt:session/expired",null,JSON.stringify({code:"EXPIRED"}))}});a.connection.hub.start(A).done(function(){j=true;r("debug/mode",{message:"55AE6F46CFB643F68CD3128A6561C18555AE6F46CFB643F68CD3128A6561C18555AE6F46CFB643F68CD3128A6561C185"});if(x.length>0){y.log("Sending subscription from queue for topic: "+JSON.stringify(x))}a.each(c,function(){s(this.topic,this.filter,this.deferred)});c=[];u.resolve()}).fail(function(C){k=true;y.log("Failed in starting connection");a.each(c,function(){this.deferred.reject(C)});c=[];u.reject(C)});return u.promise()};var p=function(){a.connection.hub.stop();u=null;f=new v();x=[];c=[];b=a.signalR.connectionState.connecting;j=false,k=false};a.connection.hub.stateChanged(function(A){b=A.newState;d("/state/change",A)});a.connection.hub.reconnected(function(){var A=function(){y.log("Resending subscription from queue for topic(s): "+x);a.each(x,function(B,C){o(C.topic,C.filter)});q();r("debug/mode",{message:"55AE6F46CFB643F68CD3128A6561C18555AE6F46CFB643F68CD3128A6561C18555AE6F46CFB643F68CD3128A6561C185"})};if(a.connection.hub.transport.name!="webSockets"){A()}else{setTimeout(A,5)}});var e={magicHub:{on:m,off:l,send:r,start:t,reset:p}};a.extend(true,a.connection,e)}(window.jQuery,window));